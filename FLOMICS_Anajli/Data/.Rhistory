options(stringsAsFactors=F)
#load libraries
packages <- c("dplyr", "readr", "ggplot2", "vcfR", "tidyr", "mclust", "data.table",
"plyr", "ggpubr",
"ggrepel", "stringr", "maftools", "magrittr", "ggExtra", "cowplot")
lapply(packages, require, character.only = TRUE)
date = Sys.Date()
#figure 2
res = readRDS("Documents/final_candidates_TCGA_PCAWG_results_100CVsofElasticNet_June15.rds")
res
res = as.data.table(filter(res, data=="TCGA"))
canc_conv = readRDS("canc_conv.rds")
colnames(canc_conv)[2] = "cancer"
z=which(res$gene_name == "HOXA-AS4")
res$gene_name[z] = "HOXA10-AS"
#figure 2
res = readRDS("Documents/final_candidates_TCGA_PCAWG_results_100CVsofElasticNet_June15.rds")
res = as.data.table(filter(res, data=="TCGA"))
canc_conv = readRDS("canc_conv.rds")
options(stringsAsFactors=F)
#load libraries
packages <- c("dplyr", "readr", "ggplot2", "vcfR", "tidyr", "mclust", "data.table",
"plyr", "ggpubr",
"ggrepel", "stringr", "maftools", "magrittr", "ggExtra", "cowplot")
lapply(packages, require, character.only = TRUE)
date = Sys.Date()
#figure 2
res = readRDS("Documents/final_candidates_TCGA_PCAWG_results_100CVsofElasticNet_June15.rds")
res = as.data.table(filter(res, data=="TCGA"))
canc_conv = readRDS("Documents/canc_conv.rds")
colnames(canc_conv)[2] = "cancer"
z=which(res$gene_name == "HOXA-AS4")
res$gene_name[z] = "HOXA10-AS"
res
res = merge(res, canc_conv, by="cancer")
t = as.data.table(table(res$type))
t = t[order(-N)]
res$type = factor(res$type, levels =t$V1)
res = res[order(type, HR)]
res
#need to order genes wtihin cancer type
res$combo = paste(res$gene_name, res$type)
res = res[order(type, HR)]
order = unique(res$gene_name)
res$gene_name = factor(res$gene_name, levels=order)
res
require(devtools)
devtools::install_github("keyuan/ccube")
---
title: "Ccube: Clustering Cancer Cell Fractions"
author: "Ke Yuan"
date: "`r Sys.Date()`"
output:
html_document:
theme: null
css: wch_style.css
toc: true
vignette: >
%\VignetteIndexEntry{Vignette Title}
%\VignetteEngine{knitr::rmarkdown}
\usepackage[utf8]{inputenc}
---
library(ccube)
#> Loading required package: foreach
library(dplyr)
#>
#> Attaching package: 'dplyr'
#> The following objects are masked from 'package:stats':
#>
#>     filter, lag
#> The following objects are masked from 'package:base':
#>
#>     intersect, setdiff, setequal, union
#library(doParallel)
options(stringsAsFactors = F)
set.seed(1234)
numSnv <- 500
ccfSet <- c(1, 0.7, 0.3) # true ccf pool
ccfTrue <- sample(ccfSet, numSnv, c(0.5,0.2,0.3), replace = T) # simulate true clusters
purity <- 0.8
cnPoolMaj <- c(1,2,3,4) # a pool of possible major copy numbers
cnPoolMin <- c(0,1,2) # a pool of possible minor copy numbers
cnPoolMajFractions <- c(1/4, 1/4, 1/4, 1/4) # prevalence of possible major copy numbers
cnPoolMinFractions <- c(1/3, 1/3, 1/3) # prevalence of possible minor copy numbers
cnProfile = GenerateCopyNumberProfile(cnPoolMaj, cnPoolMin,
cnPoolMajFractions, cnPoolMinFractions, numSnv)
cnProfile
baseDepth = 40
mydata <- data.frame(mutation_id = paste0("ss","_", seq_len(numSnv)) ,
ccf_true = ccfTrue,
minor_cn = cnProfile[,1],
major_cn = cnProfile[,2],
total_cn = cnProfile[,3],
purity = purity,
normal_cn = 2)
mydata <- dplyr::mutate(rowwise(mydata),
mult_true = sample(seq(1,if (major_cn ==1) { 1 } else {major_cn}), 1), # simulate multiplicity
vaf_true = cp2ap(ccf_true, purity, normal_cn, total_cn, total_cn, mult_true), # simulate vaf
total_counts = rpois(1, total_cn/2 * baseDepth), # simulate total read counts
var_counts = rbinom(1, total_counts, vaf_true),  # simulate variant read counts
ref_counts = total_counts - var_counts)
head(mydata)
#> Source: local data frame [6 x 12]
View(mydata)
numOfClusterPool = 1:6
numOfRepeat = 1
results <- RunCcubePipeline(ssm = mydata,
numOfClusterPool = numOfClusterPool,
numOfRepeat = numOfRepeat,
runAnalysis = T,
runQC = T)
results$ssm
ssm = results$ssm
View(ssm)
View(mydata)
mydata$ccf_true = NULL
numOfClusterPool = 1:6
numOfRepeat = 1
results <- RunCcubePipeline(ssm = mydata,
numOfClusterPool = numOfClusterPool,
numOfRepeat = numOfRepeat,
runAnalysis = T,
runQC = T)
?RunCcubePipeline
mydat
mydata
mydata
View(mydata)
mydata_test = mydata
mydata_test$purity = NULL
numOfClusterPool = 1:6
numOfRepeat = 1
results <- RunCcubePipeline(ssm = mydata,
numOfClusterPool = numOfClusterPool,
numOfRepeat = numOfRepeat,
runAnalysis = T,
runQC = T)
mydata
numOfClusterPool = 1:6
numOfRepeat = 1
results <- RunCcubePipeline(ssm = mydata_test,
numOfClusterPool = numOfClusterPool,
numOfRepeat = numOfRepeat,
runAnalysis = T,
runQC = T)
View(mydata_test)
View(mydata_test)
?GetPurity
mydata_test$mult_true= NULL
mydata_test$vaf_true = NULL
numOfClusterPool = 1:6
numOfRepeat = 1
results <- RunCcubePipeline(ssm = mydata_test,
numOfClusterPool = numOfClusterPool,
numOfRepeat = numOfRepeat,
runAnalysis = T,
runQC = T)
library(devtools)
install_github("hanasusak/cDriver")
library(cDriver)
library(maftools)
var.annovar <- system.file("extdata", "variants.hg19_multianno.txt", package = "maftools")
var.annovar.maf <- annovarToMaf(annovar = var.annovar, Center = 'CSI-NUS', refBuild = 'hg19',
tsbCol = 'Tumor_Sample_Barcode', table = 'ensGene', header = TRUE)
var.annovar <- system.file("extdata", "variants.hg19_multianno.txt", package = "maftools")
var.annovar
var.annovar.maf <- annovarToMaf(annovar = var.annovar, Center = 'CSI-NUS', refBuild = 'hg19',
tsbCol = 'Tumor_Sample_Barcode', table = 'ensGene', header = TRUE)
var.annovar.maf <- annovarToMaf(annovar = var.annovar, Center = 'CSI-NUS', refBuild = 'hg19',
tsbCol = 'Tumor_Sample_Barcode', table = 'ensGene')
#----------------------------------------------------------------------
#variants_004_summary_visualize.R
#----------------------------------------------------------------------
#----------------------------------------------------------------------
#load functions and libraries
#----------------------------------------------------------------------
options(stringsAsFactors=F)
#load libraries
packages <- c("dplyr", "readr", "ggplot2", "vcfR", "tidyr", "mclust", "data.table", "plyr",
"ggrepel", "stringr", "maftools", "VariantAnnotation", "ggpubr")
lapply(packages, require, character.only = TRUE)
library(Biobase)
# Convert the row names to entrez ids
library("AnnotationDbi")
library("org.Hs.eg.db")
columns(org.Hs.eg.db)
date = Sys.Date()
#do this locally - transfer files from cluster
#/cluster/projects/kridelgroup/FLOMICS/variant_analysis_folder/SNP_matrices_all_algortihms
setwd("/Users/kisaev/FLOMICS_Anjali/FLOMICS_Anajli/Data")
#----------------------------------------------------------------------
#purpose
#----------------------------------------------------------------------
#how did we get here?
#----------------------------------------------------------------------
#data
#----------------------------------------------------------------------
variant_files = list.files(pattern="_.rds")
z = which(str_detect(variant_files, "Anjali"))
variant_files=variant_files[-z]
#gene annotations
genes = unique(fread("ucsc_table_browser_gene_IDs.txt"))
colnames(genes)[2] = "Gene.ensGene"
#----------------------------------------------------------------------
#analysis
#----------------------------------------------------------------------
#generate summary results
summary_vars = function(variants){
#extract name of tool that was used to call variants and whether they are INDELs or SNPs
variants_callers=paste(unlist(strsplit(variants, "_"))[3:5], collapse=" ")
print(variants_callers)
mut_type = "SNV"
indel1 = !(length(which(str_detect(variants, "indel")))==0)
indel2 = !(length(which(str_detect(variants, "INDEL")))==0)
if(indel1 | indel2){
mut_type="INDEL"
}
#read in file
var_dat = readRDS(variants)
#remove population variants via snpdb
var_dat$avsnp142 = as.character(var_dat$avsnp142)
z = which(str_detect(var_dat$avsnp142, "rs"))
if(!(length(z)==0)){
var_dat = var_dat[-z,]
}
#remove potential population variants with high popluation allele frequencies
var_dat$AF_popmax = as.numeric(as.character(var_dat$AF_popmax))
var_dat = as.data.table(filter(var_dat, ((is.na(AF_popmax) )| AF_popmax < 0.005)))
var_dat$Gene.ensGene = as.character(var_dat$Gene.ensGene)
#check if some mutations are potentially artifacts
#summary of actual mutations
freq_muts = as.data.table(filter(as.data.table(table(var_dat$patient, var_dat$id, var_dat$Gene.ensGene)), N >=1))
freq_muts$combo = paste(freq_muts$V2, freq_muts$V3)
freq_muts = as.data.table(table(freq_muts$combo))
freq_muts = freq_muts[order(-N)]
freq_muts$tag[freq_muts$N > 0.05 * length(unique(var_dat$patient))] = "tagged"
var_dat$combo = paste(var_dat$id, var_dat$Gene.ensGene)
z = which(var_dat$combo %in% freq_muts$V1[freq_muts$tag=="tagged"])
var_dat$tag = ""
if(!(length(z)==0)){
var_dat$tag[z] = "tagged"
}
#get gene names
#ensembl to gene ID
#if multiple genes mapped to variant (usually if in between genes or upstream of genes, or if gene has multiple ENSG ids)
#keep id of first gene
var_dat$Gene.ensGene = sapply(var_dat$Gene.ensGene, function(t){unlist(strsplit(t, '\\x', fixed=TRUE))[1]})
var_dat$Gene.ensGene = as.character(var_dat$Gene.ensGene)
var_dat = merge(var_dat, genes , by = "Gene.ensGene", allow.cartesian=TRUE)
var_dat = as.data.table(filter(var_dat, !(is.na(hg19.ensemblToGeneName.value))))
pdf(paste("/Users/kisaev/FLOMICS_Anjali/FLOMICS_Anajli/Plots/", variants_callers, "plots.pdf", sep="_"), width=15, height=10)
#1. summary of # of muts per patient
freq_pats = as.data.table(table(var_dat$patient))
freq_pats = freq_pats[order(-N)]
print(ggbarplot(freq_pats, x = "V1", y="N", fill="grey") +theme_bw() +
rotate_x_text(65) + ylab("Number of called mutations") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
#2. summary genes  mutations
freq_genes = as.data.table(filter(as.data.table(table(var_dat$patient, var_dat$hg19.ensemblToGeneName.value)), N >=1))
freq_genes = as.data.table(table(freq_genes$V2))
freq_genes = freq_genes[order(-N)]
print(ggbarplot(freq_genes, x = "V1", y="N", fill="grey") +theme_bw() +
rotate_x_text(65) + ylab("Number of patients with mutation") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
#3. summary of where in genome mutations fall
table(as.character(var_dat$Func.ensGene))
#print(ggbarplot(freq_muts, x = "V1", y="N", fill="grey") +theme_bw() +
#  rotate_x_text(90) + ylab("Number of patients with mutation") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
dev.off()
#finally save final RDS files with either INDELs or SNPs for Anjali to conduct further analysis..
data_type = paste(unlist(strsplit(variants, "_"))[3:5], collapse="_")
var_dat$data_type = data_type
saveRDS(var_dat, file=paste(date, data_type, "final_version_for_Anjali.rds", sep="_"))
var_dat$mut_type = mut_type
return(var_dat)
}
#apply to all
all_muts = as.data.table(ldply(llply(variant_files, summary_vars)))
all_muts$combo = paste(all_muts$id, all_muts$hg19.ensemblToGeneName.value)
#summary
all_muts_sum = as.data.table(table(all_muts$combo, all_muts$data_type, all_muts$mut_type))
all_muts_sum = as.data.table(filter(all_muts_sum, N >0))
colnames(all_muts_sum) = c("mut_id", "mutation_caller", "type_mut", "num_patients")
all_muts_sum
View(all_muts_sum)
head(all_muts)
filter(all_muts, id == "	12:49432678_G/A")
filter(all_muts, id == "12:49432678_G/A")
filter(all_muts, id == "12:49432678_G/A")$patient
unique(all_muts_sum$mutation_caller)
variant_files
all_muts
all_muts$data_type
unique(all_muts$data_type)
unique(all_muts_sum$mutation_caller)
variant_fies
variant_files
variantst=variant_files[6]
variants
variants
variatnts=variant_files[6]
variants
variants=variant_files[6]
variants
#extract name of tool that was used to call variants and whether they are INDELs or SNPs
variants_callers=paste(unlist(strsplit(variants, "_"))[3:5], collapse=" ")
print(variants_callers)
mut_type = "SNV"
indel1 = !(length(which(str_detect(variants, "indel")))==0)
indel2 = !(length(which(str_detect(variants, "INDEL")))==0)
if(indel1 | indel2){
mut_type="INDEL"
}
mut_type
#read in file
var_dat = readRDS(variants)
#remove population variants via snpdb
var_dat$avsnp142 = as.character(var_dat$avsnp142)
z = which(str_detect(var_dat$avsnp142, "rs"))
if(!(length(z)==0)){
var_dat = var_dat[-z,]
}
#remove potential population variants with high popluation allele frequencies
var_dat$AF_popmax = as.numeric(as.character(var_dat$AF_popmax))
var_dat = as.data.table(filter(var_dat, ((is.na(AF_popmax) )| AF_popmax < 0.005)))
var_dat$Gene.ensGene = as.character(var_dat$Gene.ensGene)
#check if some mutations are potentially artifacts
#summary of actual mutations
freq_muts = as.data.table(filter(as.data.table(table(var_dat$patient, var_dat$id, var_dat$Gene.ensGene)), N >=1))
freq_muts$combo = paste(freq_muts$V2, freq_muts$V3)
freq_muts = as.data.table(table(freq_muts$combo))
freq_muts = freq_muts[order(-N)]
freq_muts$tag[freq_muts$N > 0.05 * length(unique(var_dat$patient))] = "tagged"
var_dat$combo = paste(var_dat$id, var_dat$Gene.ensGene)
z = which(var_dat$combo %in% freq_muts$V1[freq_muts$tag=="tagged"])
var_dat$tag = ""
if(!(length(z)==0)){
var_dat$tag[z] = "tagged"
}
var_dat
#if multiple genes mapped to variant (usually if in between genes or upstream of genes, or if gene has multiple ENSG ids)
#keep id of first gene
var_dat$Gene.ensGene = sapply(var_dat$Gene.ensGene, function(t){unlist(strsplit(t, '\\x', fixed=TRUE))[1]})
var_dat$Gene.ensGene = as.character(var_dat$Gene.ensGene)
var_dat = merge(var_dat, genes , by = "Gene.ensGene", allow.cartesian=TRUE)
var_dat = as.data.table(filter(var_dat, !(is.na(hg19.ensemblToGeneName.value))))
var_dat
variants
pdf(paste("/Users/kisaev/FLOMICS_Anjali/FLOMICS_Anajli/Plots/", variants_callers, "plots.pdf", sep="_"), width=15, height=10)
#1. summary of # of muts per patient
freq_pats = as.data.table(table(var_dat$patient))
freq_pats = freq_pats[order(-N)]
print(ggbarplot(freq_pats, x = "V1", y="N", fill="grey") +theme_bw() +
rotate_x_text(65) + ylab("Number of called mutations") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
#2. summary genes  mutations
freq_genes = as.data.table(filter(as.data.table(table(var_dat$patient, var_dat$hg19.ensemblToGeneName.value)), N >=1))
freq_genes = as.data.table(table(freq_genes$V2))
freq_genes = freq_genes[order(-N)]
print(ggbarplot(freq_genes, x = "V1", y="N", fill="grey") +theme_bw() +
rotate_x_text(65) + ylab("Number of patients with mutation") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
#3. summary of where in genome mutations fall
table(as.character(var_dat$Func.ensGene))
dev.off()
#finally save final RDS files with either INDELs or SNPs for Anjali to conduct further analysis..
data_type = paste(unlist(strsplit(variants, "_"))[3:5], collapse="_")
var_dat$data_type = data_type
var_dat
variants
variants
variant_files
#finally save final RDS files with either INDELs or SNPs for Anjali to conduct further analysis..
data_type = paste(unlist(strsplit(variants, "_"))[3:6], collapse="_")
var_dat$data_type = data_type
saveRDS(var_dat, file=paste(date, data_type, "final_version_for_Anjali.rds", sep="_"))
var_dat$mut_type = mut_type
var_Dat
var_dat
#----------------------------------------------------------------------
#variants_004_summary_visualize.R
#----------------------------------------------------------------------
#----------------------------------------------------------------------
#load functions and libraries
#----------------------------------------------------------------------
options(stringsAsFactors=F)
#load libraries
packages <- c("dplyr", "readr", "ggplot2", "vcfR", "tidyr", "mclust", "data.table", "plyr",
"ggrepel", "stringr", "maftools", "VariantAnnotation", "ggpubr")
lapply(packages, require, character.only = TRUE)
library(Biobase)
# Convert the row names to entrez ids
library("AnnotationDbi")
library("org.Hs.eg.db")
columns(org.Hs.eg.db)
date = Sys.Date()
#do this locally - transfer files from cluster
#/cluster/projects/kridelgroup/FLOMICS/variant_analysis_folder/SNP_matrices_all_algortihms
setwd("/Users/kisaev/FLOMICS_Anjali/FLOMICS_Anajli/Data")
#----------------------------------------------------------------------
#purpose
#----------------------------------------------------------------------
#how did we get here?
#----------------------------------------------------------------------
#data
#----------------------------------------------------------------------
variant_files = list.files(pattern="_.rds")
z = which(str_detect(variant_files, "Anjali"))
variant_files=variant_files[-z]
#gene annotations
genes = unique(fread("ucsc_table_browser_gene_IDs.txt"))
colnames(genes)[2] = "Gene.ensGene"
#----------------------------------------------------------------------
#analysis
#----------------------------------------------------------------------
#generate summary results
summary_vars = function(variants){
#extract name of tool that was used to call variants and whether they are INDELs or SNPs
variants_callers=paste(unlist(strsplit(variants, "_"))[3:5], collapse=" ")
print(variants_callers)
mut_type = "SNV"
indel1 = !(length(which(str_detect(variants, "indel")))==0)
indel2 = !(length(which(str_detect(variants, "INDEL")))==0)
if(indel1 | indel2){
mut_type="INDEL"
}
#read in file
var_dat = readRDS(variants)
#remove population variants via snpdb
var_dat$avsnp142 = as.character(var_dat$avsnp142)
z = which(str_detect(var_dat$avsnp142, "rs"))
if(!(length(z)==0)){
var_dat = var_dat[-z,]
}
#remove potential population variants with high popluation allele frequencies
var_dat$AF_popmax = as.numeric(as.character(var_dat$AF_popmax))
var_dat = as.data.table(filter(var_dat, ((is.na(AF_popmax) )| AF_popmax < 0.005)))
var_dat$Gene.ensGene = as.character(var_dat$Gene.ensGene)
#check if some mutations are potentially artifacts
#summary of actual mutations
freq_muts = as.data.table(filter(as.data.table(table(var_dat$patient, var_dat$id, var_dat$Gene.ensGene)), N >=1))
freq_muts$combo = paste(freq_muts$V2, freq_muts$V3)
freq_muts = as.data.table(table(freq_muts$combo))
freq_muts = freq_muts[order(-N)]
freq_muts$tag[freq_muts$N > 0.05 * length(unique(var_dat$patient))] = "tagged"
var_dat$combo = paste(var_dat$id, var_dat$Gene.ensGene)
z = which(var_dat$combo %in% freq_muts$V1[freq_muts$tag=="tagged"])
var_dat$tag = ""
if(!(length(z)==0)){
var_dat$tag[z] = "tagged"
}
#get gene names
#ensembl to gene ID
#if multiple genes mapped to variant (usually if in between genes or upstream of genes, or if gene has multiple ENSG ids)
#keep id of first gene
var_dat$Gene.ensGene = sapply(var_dat$Gene.ensGene, function(t){unlist(strsplit(t, '\\x', fixed=TRUE))[1]})
var_dat$Gene.ensGene = as.character(var_dat$Gene.ensGene)
var_dat = merge(var_dat, genes , by = "Gene.ensGene", allow.cartesian=TRUE)
var_dat = as.data.table(filter(var_dat, !(is.na(hg19.ensemblToGeneName.value))))
pdf(paste("/Users/kisaev/FLOMICS_Anjali/FLOMICS_Anajli/Plots/", variants_callers, "plots.pdf", sep="_"), width=15, height=10)
#1. summary of # of muts per patient
freq_pats = as.data.table(table(var_dat$patient))
freq_pats = freq_pats[order(-N)]
print(ggbarplot(freq_pats, x = "V1", y="N", fill="grey") +theme_bw() +
rotate_x_text(65) + ylab("Number of called mutations") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
#2. summary genes  mutations
freq_genes = as.data.table(filter(as.data.table(table(var_dat$patient, var_dat$hg19.ensemblToGeneName.value)), N >=1))
freq_genes = as.data.table(table(freq_genes$V2))
freq_genes = freq_genes[order(-N)]
print(ggbarplot(freq_genes, x = "V1", y="N", fill="grey") +theme_bw() +
rotate_x_text(65) + ylab("Number of patients with mutation") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
#3. summary of where in genome mutations fall
table(as.character(var_dat$Func.ensGene))
#print(ggbarplot(freq_muts, x = "V1", y="N", fill="grey") +theme_bw() +
#  rotate_x_text(90) + ylab("Number of patients with mutation") + xlab("Patient") + ggtitle(paste(variants_callers, ",n=", dim(freq_pats)[1], "at least 1 mutation")))
dev.off()
#finally save final RDS files with either INDELs or SNPs for Anjali to conduct further analysis..
data_type = paste(unlist(strsplit(variants, "_"))[3:6], collapse="_")
var_dat$data_type = data_type
saveRDS(var_dat, file=paste(date, data_type, "final_version_for_Anjali.rds", sep="_"))
var_dat$mut_type = mut_type
return(var_dat)
}
#apply to all
all_muts = as.data.table(ldply(llply(variant_files, summary_vars)))
all_muts$combo = paste(all_muts$id, all_muts$hg19.ensemblToGeneName.value)
#summary
all_muts_sum = as.data.table(table(all_muts$combo, all_muts$data_type, all_muts$mut_type))
all_muts_sum = as.data.table(filter(all_muts_sum, N >0))
colnames(all_muts_sum) = c("mut_id", "mutation_caller", "type_mut", "num_patients")
View(all_muts_sum)
all_muts_sum2=all_muts_sum
View(all_muts_sum2)
justlowfreq = as.data.table(filter(all_muts, data_type == "loFreq_VCFs_.rds_NA""))
)
)
justlowfreq = as.data.table(filter(all_muts, data_type == "loFreq_VCFs_.rds_NA"))
View(justlowfreq)
nolofreq = as.data.table(filter(all_muts, !(data_type == "loFreq_VCFs_.rds_NA"), mut_type=="SNV")
)
View(nolofreq)
filter(nolofreq, id %in% justlowfreq$id)
both = as.data.table(filter(nolofreq, id %in% justlowfreq$id))
table(both$data_type)
length(unique(justlowfreq$id))
length(unique(nolofreq$id))
length(unique(both$id))
unique(nolofreq$data_type)
721/2521
plat_only = as.data.table(filter(all_muts, data_type == "loFreq_platypus_SNP_VCFs"))
plat_only
length(unique(plat_only$id))
plat_only
table(plat_only$patitent)
table(plat_only$patient)
length(unique(plat_only$id))
